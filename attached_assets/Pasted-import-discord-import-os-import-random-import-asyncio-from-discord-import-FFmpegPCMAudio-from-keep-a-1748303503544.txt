import discord
import os
import random
import asyncio
from discord import FFmpegPCMAudio
from keep_alive import keep_alive

intents = discord.Intents.default()
intents.message_content = True
client = discord.Client(intents=intents)

is_sleeping = True

falas_doro = [
    "Doro!", "DORO DORO", "Doro?", "Doro......",
    "Dorodorodorodorodorodorodorodoro", "# DORO", "d o r o", "*doro*",
    "**DORO?!**", "doroooooooooooooo", "D.o.r.o.", "d o r o ?", "d-Doro...",
    "DoRoDoRoDoRo", "dorodododorododoro", "üí• DORO üí•",
    "doro.exe has stopped working", "> Doro est√° digitando...",
    "üß† DORO THOUGHTS üß†", "D-O-R-O", "doro (em choque)", "doro: o retorno",
    "doro v2.0", "Doro...? DORO!! DOROOOOOO!!", "doro... doro... doro...",
    "D O R O", "doro doro doro doro doro doro doro doro doro doro doro",
    "*DORO EST√Å ENTRE N√ìS*", "Dorororororororororororororororororo!",
    "Doro entrou no chat.", "Doro saindo do servidor... adeus.",
    "Doro foi banida por excesso de Doro.", "‚ö†Ô∏è ALARME DE DORO ‚ö†Ô∏è",
    "Dorant√°stico!", "üí£üí£**DORO!**üí£üí£",
    "Voc√™ j√° parou pra pensar... que talvez tudo seja Doro?", "doro :3",
    "# **DORO ACTIVATED**",
    "doro doro? doro doro! DORO!!! doro https://c.tenor.com/aDdEI4la1V0AAAAd/tenor.gif",
    "~doro~", "„Éâ„É≠ „Éâ„É≠ „Éâ„É≠ „Éâ„É≠ „Éâ„É≠"
]

gifs_doro = [
    "https://tenor.com/view/doro-gif-1748499123257475241",
    "https://cdn.discordapp.com/attachments/1273933801860366348/1371509159584993430/s.gif",
    "https://i.redd.it/d4fjkyrwjkid1.gif",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374538002243522640/1fi2qb1iu9yb1.png?ex=6833afc5&is=68325e45&hm=e856ecc7c56241403324a2600897d73973151a96ee1e90f915da64a465368229&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374543223745151037/222a7uciafie1.gif?ex=6833b4a2&is=68326322&hm=65b64230c52e8ce47f0123d40b1168c01821d1376e1a1c90427821c049d29b42&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374543223405416458/a8ghchaqafie1.gif?ex=6833b4a2&is=68326322&hm=3a77185ea49aa8835dcbc305f3c9e4e8c09126d58d5c6d3e2dc7e17e3753637b&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374543223061614715/r92v8l72bfie1.gif?ex=6833b4a2&is=68326322&hm=4ccaa12a8d79b18d4e24ca0c69ce297cfb573f7f4efb19e60197080d9a57fe0a&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374543224106127450/6icng4sis84e1.gif?ex=6833b4a2&is=68326322&hm=5d845b79d6038ee7b9b201f01049b897820876e008888c766e2c089263f6b014&",
    "https://c.tenor.com/sV9KcBQ_xlcAAAAd/tenor.gif",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374540077514100809/67c02629a06991QJ.gif?ex=6833b1b4&is=68326034&hm=fcb4ce861f0cba52caf0c565c5da10486a1fc864863ec2521ce4c8b78a9ce3ce&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374264845280481322/doro_elegante.gif?ex=68335a1f&is=6832089f&hm=4e13cad8459e12aab98397144079c825e2a92f69e4ea428ad58e024756d8d0e9&",
    "https://cdn.discordapp.com/attachments/803745174886678599/1352135656565899275/IMG_6281.gif?ex=68334435&is=6831f2b5&hm=508670f44b1a1b53d8268909aebf6cf14a593536ce29d0ad4a705890e33409bb&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374537057388593202/Dorosaur.gif?ex=6833aee4&is=68325d64&hm=6b33d6b32842b2381e4f7b188130b70af76f226b6b0711b2ba5aace366ad26ad&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374271786710995104/05054-ezgif.com-speed.gif?ex=68336096&is=68320f16&hm=5111805097cc8e257f7e55da6d05963136c7de500643cb7b6c5b1bd5ad01e423&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374533653534871683/hooyg8l4420f1.gif?ex=6833abb8&is=68325a38&hm=1f608272d379547420382d5b6120e69160761355c0f69c2dbab3aa0b072a1c5a&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374533587285839966/HnVideoEditor_2025_05_17_074702035.gif?ex=6833aba8&is=68325a28&hm=89c61176f5e00a4d61c3b48e50f9bdb1a6ef3074accad4b40def767862433c5a&",
    "https://cdn.discordapp.com/attachments/525224345514147842/1348974746364153967/IMG_3514.gif?ex=6833a1e2&is=68325062&hm=98e20e9c16c4433d135312c2acfa79be70d6b13d623592c414b30522c41baf73&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1371196568421662830/IMG_5055.gif?ex=68336551&is=683213d1&hm=174135ba02ddfc68db45a575e59232cae325544985c3f4fa2180fab22dc4ee96&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1372797570879066183/editoro8-ezgif.com-video-to-gif-converter.gif?ex=6833499e&is=6831f81e&hm=2eb055c4c5d1d3255ec31ee5b6aedb2a6e2b9d5e5622c544b75cb46962549e52&",
    "https://cdn.discordapp.com/attachments/603549683897597952/1373508856117858345/HnVideoEditor_2025_05_18_083250977-ezgif.com-loop-count.gif?ex=68333d0d&is=6831eb8d&hm=08a42ec1b91c49313d1d62a658ceaea4242612d5631804ddc2941fd061ee18d2&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1341091403425644574/IMG_4712.gif?ex=68334c32&is=6831fab2&hm=3c541e4e4db0a0c32b38fe3c99da7577e0a9ac37bf29b8156d94b963331d6563&",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1356553156397633669/IMG_5373.gif?ex=68338454&is=683232d4&hm=1ea4919616271dad47e53768acf919dff97eba082ea1a62bfb4946d9df704320&",
    "https://cdn.discordapp.com/attachments/1340040586232598538/1359782702714458193/IMG_5554.gif?ex=68336693&is=68321513&hm=3fad226af02a5a33468f1cc7df5e1a027b5a7f65efb6c701a2f728818909b16e&",
    "https://c.tenor.com/aDdEI4la1V0AAAAd/tenor.gif",
    "https://tenor.com/view/doro-nikke-middle-finger-funny-gif-9412621914012263607",
    "https://tenor.com/view/doro-dorothy-fat-doritos-nikke-gif-3638811687278101957",
    "https://tenor.com/view/dorothy-nikke-doro-gif-7509545823082567005",
    "https://cdn.discordapp.com/attachments/1273933998762229845/1374534306516439111/doro-made-a-drink-for-you-how-nice-v0-ipjcl6hu95zb1.png?ex=6833ac54&is=68325ad4&hm=77660fb34086e12db36a4e625810889665e863c76376a7f8a4e671843a425af2&",
    "https://tenor.com/view/doro-dorothy-nikke-gif-3492096921929364235"
]

gifs_bom_dia = [
    "https://cdn.discordapp.com/attachments/1060437247524077608/1355851381902147705/0742422FA27C6A6C9663A71F9F25F7C1.gif",
    "https://media.discordapp.net/attachments/634987495712358400/1302236316477685780/doro_rise.gif"
]


# Evento ao iniciar
@client.event
async def on_ready():
    print(f'Bot conectado como {client.user}')
    await client.change_presence(status=discord.Status.invisible)
    client.loop.create_task(check_voice_channel())


# Fun√ß√£o para verificar se est√° sozinho no canal de voz
async def check_voice_channel():
    while True:
        for guild in client.guilds:
            if guild.voice_client:
                channel = guild.voice_client.channel
                if len(channel.members) <= 1:
                    await guild.voice_client.disconnect()
                else:
                    if not guild.voice_client.is_playing():
                        delay = random.randint(300, 1800)
                        await asyncio.sleep(delay)
                        if guild.voice_client and len(channel.members) > 1:
                            sound_file = f'Sounds/doro{random.randint(1,10)}.ogg'
                            source = FFmpegPCMAudio(sound_file)
                            guild.voice_client.play(source)
        await asyncio.sleep(5)


# Evento ao receber mensagens
@client.event
async def on_message(message):
    global is_sleeping

    if message.author == client.user:
        return

    conteudo = message.content.lower()

    # Respostas fixas
    if 'doro hentai' in conteudo:
        await message.channel.send(
            "https://media.discordapp.net/stickers/1291711474917445673.gif")

    # 1% de chance de Doro responder "doro" a qualquer mensagem
    elif random.randint(1, 100) <= 10:
        await message.channel.send("doro")

    elif message.content.lower().startswith("doro libertar carga"):
        await message.channel.send("‚ö†Ô∏è ***Sobrecarga detectada...***")
        await asyncio.sleep(3)
        await message.channel.send("üíì *Pressurizando reservat√≥rio de dados...*"
                                   )
        await asyncio.sleep(4)
        await message.channel.send(
            "üí¶üí• *EJACULANDO PACOTES BIN√ÅRIOS EM DIRE√á√ÉO AO PLANO MATERIAL!!!*")

    elif 'doro hental' in conteudo:
        await message.channel.send(
            "https://cdn2.hentaigifz.com/93580/hardfuck.gif")

    elif any(
            kw in conteudo for kw in
        ['boa noite doro', 'doro boa noite', 'dorme doro', 'vai dormir doro']):
        if not is_sleeping:
            await message.channel.send(
                "https://cdn.discordapp.com/attachments/1238539497537540137/1375663363140354128/image.png"
            )
            is_sleeping = True
            await client.change_presence(status=discord.Status.invisible)

    elif any(kw in conteudo for kw in [
            'doro bom dia', 'doro bomdia', 'bom dia doro', 'bomdia doro',
            'acorda doro', 'doro acorda'
    ]):
        is_sleeping = False
        await client.change_presence(status=discord.Status.online)
        await message.channel.send(random.choice(gifs_bom_dia))

    elif 'doro kill' in conteudo:
        await message.channel.send(
            "https://cdn.discordapp.com/attachments/1273933801860366348/1365152597337444433/sk6knfnktlmd1.gif"
        )

    elif any(x in conteudo for x in [
            'morre doro', 'vai se foder doro', 'vai se fude doro',
            'doro se mata', 'se mata doro'
    ]):
        await message.channel.send(
            "https://cdn.discordapp.com/attachments/684383483640152094/1375662630097915914/image.png"
        )

    elif 'entra doro' in conteudo and not is_sleeping:
        if message.author.voice:
            channel = message.author.voice.channel
            try:
                voice_client = await channel.connect()
                sound_file = f'Sounds/doro{random.randint(1,10)}.ogg'
                source = FFmpegPCMAudio(sound_file)
                voice_client.play(source)
                await message.channel.send("DORO! üéµ")
            except Exception as e:
                print(f"Erro ao entrar na call: {e}")
                if message.guild.voice_client:
                    await message.guild.voice_client.disconnect()
        else:
            await message.channel.send(
                "Voc√™ precisa estar em um canal de voz primeiro!")

    elif 'sai doro' in conteudo:
        if message.guild.voice_client:
            await message.guild.voice_client.disconnect()
            await message.channel.send("Tchau... üëã")

    elif 'doro?' in conteudo:
        emojis = [
            'üëÄ', '‚ùì', 'üßê', 'üò≥', 'ü§®', 'üò∂', 'üëç', 'üëé', '‚ù§Ô∏è', 'üî•', 'ü§≠', 'üêÇ', 'üôè',
            'ü§´'
        ]
        emoji = random.choice(emojis)
        await message.add_reaction(emoji)

    # Mensagem aleat√≥ria de Doro
    elif 'doro' in conteudo:
        if not is_sleeping:
            escolha = random.choice(falas_doro + gifs_doro)
            await message.channel.send(escolha)


client.run(os.getenv(
    "DISCORD_TOKEN"))  # ou cole o token direto aqui se n√£o usar env vars
